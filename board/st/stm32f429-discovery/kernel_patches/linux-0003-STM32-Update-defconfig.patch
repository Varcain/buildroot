From f901ee694837fa14409f67795092f790f3e81e43 Mon Sep 17 00:00:00 2001
From: Kamil Lulko <rev13@wp.pl>
Date: Sat, 17 Oct 2015 12:40:46 +0200
Subject: [PATCH 3/3] STM32: Update defconfig

---
 arch/arm/configs/stm32_defconfig | 15 ++++++++++-----
 1 file changed, 10 insertions(+), 5 deletions(-)

diff --git a/arch/arm/configs/stm32_defconfig b/arch/arm/configs/stm32_defconfig
index 4725fab..8582b92 100644
--- a/arch/arm/configs/stm32_defconfig
+++ b/arch/arm/configs/stm32_defconfig
@@ -1,7 +1,6 @@
 CONFIG_NO_HZ_IDLE=y
 CONFIG_HIGH_RES_TIMERS=y
 CONFIG_LOG_BUF_SHIFT=16
-CONFIG_BLK_DEV_INITRD=y
 CONFIG_CC_OPTIMIZE_FOR_SIZE=y
 # CONFIG_UID16 is not set
 # CONFIG_BASE_FULL is not set
@@ -21,21 +20,24 @@ CONFIG_EMBEDDED=y
 CONFIG_ARM_SINGLE_ARMV7M=y
 CONFIG_ARCH_STM32=y
 CONFIG_SET_MEM_PARAM=y
-CONFIG_DRAM_BASE=0x90000000
+CONFIG_DRAM_BASE=0xD0000000
 CONFIG_FLASH_MEM_BASE=0x08000000
 CONFIG_FLASH_SIZE=0x00200000
 CONFIG_PREEMPT=y
-# CONFIG_ATAGS is not set
 CONFIG_ZBOOT_ROM_TEXT=0x0
 CONFIG_ZBOOT_ROM_BSS=0x0
 CONFIG_XIP_KERNEL=y
-CONFIG_XIP_PHYS_ADDR=0x08008000
+CONFIG_XIP_PHYS_ADDR=0x08044040
 CONFIG_BINFMT_FLAT=y
 CONFIG_BINFMT_SHARED_FLAT=y
 # CONFIG_COREDUMP is not set
 CONFIG_DEVTMPFS=y
 CONFIG_DEVTMPFS_MOUNT=y
 # CONFIG_FW_LOADER is not set
+CONFIG_MTD=y
+CONFIG_MTD_BLOCK=y
+CONFIG_MTD_ROM=y
+CONFIG_MTD_UCLINUX=y
 # CONFIG_BLK_DEV is not set
 CONFIG_EEPROM_93CX6=y
 # CONFIG_INPUT is not set
@@ -57,6 +59,8 @@ CONFIG_LEDS_TRIGGER_HEARTBEAT=y
 # CONFIG_FILE_LOCKING is not set
 # CONFIG_DNOTIFY is not set
 # CONFIG_INOTIFY_USER is not set
+CONFIG_ROMFS_FS=y
+CONFIG_ROMFS_BACKED_BY_MTD=y
 CONFIG_NLS=y
 CONFIG_PRINTK_TIME=y
 CONFIG_DEBUG_INFO=y
@@ -65,6 +69,7 @@ CONFIG_DEBUG_INFO=y
 CONFIG_MAGIC_SYSRQ=y
 # CONFIG_SCHED_DEBUG is not set
 # CONFIG_DEBUG_BUGVERBOSE is not set
-# CONFIG_FTRACE is not set
+CONFIG_DEBUG_LL=y
 CONFIG_CRC_ITU_T=y
 CONFIG_CRC7=y
+CONFIG_XZ_DEC=y
-- 
2.3.1.167.g7f4ba4b

